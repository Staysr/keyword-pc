{"remainingRequest":"/Users/admin/Desktop/关键词pc/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/admin/Desktop/关键词pc/src/views/info.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/admin/Desktop/关键词pc/src/views/info.vue","mtime":1637825171438},{"path":"/Users/admin/Desktop/关键词pc/node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/关键词pc/node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/admin/Desktop/关键词pc/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/admin/Desktop/关键词pc/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/关键词pc/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtY2FyZF9fYm9keSB7CiAgcGFkZGluZzogMHB4Owp9Cg=="},{"version":3,"sources":["info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAucA;AACA;AACA","file":"info.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"width: 100%; margin-left: 20px;margin-top: 40px; display: block; position: relative;top: 30px;\">\r\n      <span style=\"font-size: 20px;\">{{ data.keyword }}</span>\r\n    </div>\r\n    <div style=\"position: relative;left: 1150px; top: 50px;\">\r\n      <el-popconfirm @confirm=\"okdelete\" confirm-button-text='好的' cancel-button-text='不用了' icon=\"el-icon-info\"\r\n        icon-color=\"red\" title=\"确定删除吗？\">\r\n        <el-button slot=\"reference\">删除</el-button>\r\n      </el-popconfirm>\r\n      <el-button style=\"margin-left: 12px;\" @click=\"cancel\" type=\"primary\">取消</el-button>\r\n    </div>\r\n    <div style=\"position: relative;left: 1080px; top: 60px;\">\r\n      <el-tag v-if=\"numlist != 0\">当前图片选中:{{ numlist }}</el-tag>\r\n      <el-tag style=\"margin-left: 12px;\" type=\"warning\" v-if=\"videonumlist != 0\">当前视频选中:{{ videonumlist }}</el-tag>\r\n    </div>\r\n    <!-- <div style=\"float: right;\">\r\n      <img  style=\"width: 100px; height: 100px;position: relative; top:-40px;right: 20px;\" />\r\n    </div> -->\r\n    <div style=\"margin-top: 50px; margin-left: 20px; width: 100%;\">\r\n      <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n        <el-tab-pane label=\"图片\" name=\"img\">\r\n          <div style=\"display: block; float: left; margin-right: 12px;\">\r\n            <div\r\n              style=\"width: 100px;height: 100px; background-color: #C0C4CC; text-align: center;vertical-align: middle;line-height: 120px;\">\r\n              <el-upload ref=\"cropperUpload\" :data=\"uploadData\" :limit=\"addsize\" :action=\"img_url\"\r\n                :on-progress=\"filedata\" :on-success=\"bg_img1\" accept=\"image/png,image/jpeg,image/jpg\"\r\n                list-type=\"picture-card\" :auto-upload=\"true\">\r\n                <i slot=\"default\" class=\"el-icon-plus\"></i>\r\n                <div slot=\"file\" slot-scope=\"{file}\">\r\n                  <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\">\r\n                  <span class=\"el-upload-list__item-actions\">\r\n                  </span>\r\n                </div>\r\n              </el-upload>\r\n            </div>\r\n          </div>\r\n          <div style=\"float: left; margin-left: 10px; margin-bottom: 12px;\" v-for=\"(item,index) in newdata.img\"\r\n            :key=\"index\">\r\n            <el-row :gutter=\"20\">\r\n              <el-col :span=\"2\">\r\n                <div style=\"width: 110px;height: 110px;\">\r\n                  <div style=\"position: relative;left: 100px;top:12px\">\r\n                    <el-checkbox-group v-model=\"checkAll\" @change=\"handleCheckChange\">\r\n                      <el-checkbox :label=\"item\">&nbsp;</el-checkbox>\r\n                    </el-checkbox-group>\r\n                  </div>\r\n                  <div>\r\n                    <el-image style=\"width: 100px;height: 100px;margin-left: 12px;\" :src=\"item.media_cover_img\"\r\n                      :preview-src-list=\"srcList\"></el-image>\r\n                  </div>\r\n                </div>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n          <!-- <el-button @click=\"keyWorddetail\" type=\"primary\">刷新</el-button> -->\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"视频\" name=\"video\">\r\n          <div style=\"display: block; float: left; margin-right: 12px;\">\r\n            <div\r\n              style=\"width: 100px;height: 100px; background-color: #C0C4CC; text-align: center;vertical-align: middle;line-height: 120px;\">\r\n              <el-upload ref=\"cropperUploadvideo\" :data=\"uploadDatavideo\" multiple :action=\"video_url\"\r\n                :on-progress=\"videofiledataf\" :on-success=\"videosuss\" accept=\".mp4\" list-type=\"picture-card\"\r\n                :auto-upload=\"true\">\r\n                <i slot=\"default\" class=\"el-icon-plus\"></i>\r\n                <div slot=\"file\" slot-scope=\"{file}\">\r\n                  <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\">\r\n                  <span class=\"el-upload-list__item-actions\">\r\n                  </span>\r\n                </div>\r\n              </el-upload>\r\n            </div>\r\n          </div>\r\n          <div style=\"float: left; margin-left: 10px; margin-bottom: 12px;\" v-for=\"(item,index) in newdata.vod\"\r\n            :key=\"index\">\r\n            <el-row :gutter=\"20\">\r\n              <el-col :span=\"2\">\r\n                <div style=\"width: 110px;height: 110px; background-color: #C0C4CC;\">\r\n                  <div style=\"position: relative;left: 80px;\">\r\n                    <el-checkbox-group v-model=\"checkAllvideo\" @change=\"handleCheckChangevideo\">\r\n                      <el-checkbox :label=\"item\">&nbsp;</el-checkbox>\r\n                    </el-checkbox-group>\r\n                  </div>\r\n                  <div>\r\n                    <img @click=\"openvideo(item.media_url)\" style=\"width: 90px;height: 90px;margin-left: 12px;\"\r\n                      :src=\"item.media_cover_img\" />\r\n                  </div>\r\n                </div>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n          <!-- <el-button @click=\"keyWorddetail\" type=\"primary\">刷新</el-button> -->\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"文字描述\" name=\"text\">\r\n          <div style=\"width: 900px;height: 900px;\">\r\n            <el-row :gutter=\"20\">\r\n              <el-col :span=\"20\">\r\n                <el-input autosize type=\"textarea\" placeholder=\"请输入内容\" v-model=\"textarea\" show-word-limit>\r\n                </el-input>\r\n              </el-col>\r\n              <el-col :span=\"2\">\r\n                <el-button @click=\"addText\" type=\"primary\">保存</el-button>\r\n              </el-col>\r\n            </el-row>\r\n            <!-- <el-row :gutter=\"20\" v-for=\"(item,index) in newdata.text\" style=\"margin-top: 12px;\">\r\n              <el-col :span=\"20\">\r\n                <el-input disabled autosize type=\"textarea\" placeholder=\"请输入内容\" v-model=\"item.media_text\" show-word-limit>\r\n                 </el-input>\r\n              </el-col>\r\n              <el-col :span=\"2\">\r\n                <el-popconfirm @confirm=\"deletetextok(item)\" confirm-button-text='好的' cancel-button-text='不用了' icon=\"el-icon-info\"\r\n                  icon-color=\"red\" title=\"确定删除吗？\">\r\n                  <el-button slot=\"reference\">删除</el-button>\r\n                </el-popconfirm>\r\n              </el-col>\r\n            </el-row> -->\r\n          </div>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n\r\n      <el-dialog title=\"视频\" :visible.sync=\"dialogVisible\" width=\"30%\">\r\n        <video controls style=\"width:100%; height:100%; object-fit: fill\" :src=\"videoopenurl\"></video>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"dialogVisible = false\">确 定</el-button>\r\n        </span>\r\n      </el-dialog>\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        timeout: '',\r\n        checkAll: [],\r\n        checkAllvideo: [],\r\n        numlist: 0,\r\n        videonumlist: 0,\r\n        partSize: '',\r\n        parallel: '',\r\n        retryCount: '',\r\n        retryDuration: '',\r\n        textid: '',\r\n        uploader: null,\r\n        videofiledata: '',\r\n        istextb: false,\r\n        addsize: 1,\r\n        region: 'cn-shanghai',\r\n        userId: '1303984639806000',\r\n        activeName: 'img',\r\n        ImageURL: '',\r\n        checkListimg: ['选中且禁用', '复选框 A'],\r\n        data: '',\r\n        name: '',\r\n        cancelname: 'img',\r\n        newdata: '',\r\n        textarea: '',\r\n        uploadAuth: '',\r\n        uploadAddress: '',\r\n        isvideo_img: 1, //type 1 默认 img 2 视频 video\r\n        videoId: '',\r\n        srcList: [],\r\n        videoopenurl: '',\r\n        dialogImageUrl: '',\r\n        dialogVisible: false,\r\n        imghandleCheckChange: [],\r\n        videohandleCheckChange: [],\r\n        img_url: localStorage.getItem('baseUrl') + '/cms/media/createUploadImage?token=' + localStorage.getItem(\r\n          'token'),\r\n        video_url: localStorage.getItem('baseUrl') + '/cms/media/createUploadVideo?token=' + localStorage.getItem(\r\n          'token'),\r\n        uploadData: {\r\n          \"title\": \"素材库\",\r\n          \"description\": \"素材库\",\r\n          \"cateId\": \"5099\",\r\n          \"tags\": \"dspseo\",\r\n          \"fileName\": '/Users/admin/Desktop/image/IMG_7536.jpg'\r\n        },\r\n        uploadDatavideo: {\r\n          \"title\": \"素材库\",\r\n          \"description\": \"素材库\",\r\n          \"cateId\": \"5100\",\r\n          \"tags\": \"dspseo\",\r\n          \"fileName\": '/Users/admin/Downloads/652ebb55fb1f2760313d10f1651a6b.MP4'\r\n        },\r\n      };\r\n    },\r\n    mounted() {\r\n      this.data = JSON.parse(this.$route.query.item);\r\n      this.name = this.$route.query.type\r\n      this.keyWorddetail()\r\n      if (this.name == -1) {\r\n        this.activeName = 'img'\r\n      } else {\r\n        this.name == 0 ? this.activeName = 'img' : (this.name == 1 ? this.activeName = 'video' : this.activeName =\r\n          'text')\r\n      }\r\n    },\r\n    methods: {\r\n      //获取素材库详情\r\n      async keyWorddetail() {\r\n        let res = await this.$api.getkeyWorddetail({\r\n          id: this.data.id,\r\n          token: localStorage.getItem('token')\r\n        });\r\n        if (res.code == 200) {\r\n          this.newdata = res.data\r\n          // for (var i = 0; i < res.data.text.length; i++) {\r\n          //   this.textarea += res.data.text[i].media_text\r\n          // }\r\n          for (var i = 0; i < res.data.img.length; i++) {\r\n            this.srcList.push(res.data.img[i].media_url)\r\n          }\r\n          this.textarea = res.data.text[0].media_text\r\n          this.textid = res.data.text.length == 0 ? this.textid == '' : res.data.text[0]\r\n            .id\r\n        } else {\r\n          this.error(res.msg)\r\n        }\r\n      },\r\n      //视频上传\r\n      async videosuss(file) {\r\n        console.log(file);\r\n        //获取上传凭证\r\n        if (file.code == 200) {\r\n          this.isvideo_img = 2;\r\n          this.uploadAuth = file.data.UploadAuth\r\n          this.uploadAddress = file.data.UploadAddress\r\n          this.videoId = file.data.VideoId\r\n          var userData = '{\"Vod\":{}}'\r\n          this.uploader = this.createUploader()\r\n          this.uploader.addFile(this.videofiledata, null, null, null, userData)\r\n          this.uploader.startUpload()\r\n        } else {\r\n          this.error(file.msg)\r\n        }\r\n      },\r\n      //文字保存\r\n      async addText() {\r\n        this.istextb = true;\r\n        let res = await this.$api.pushaddText({\r\n          id: this.textid,\r\n          keyword_id: this.data.id,\r\n          keyword: this.data.keyword,\r\n          media_text: this.textarea,\r\n          token: localStorage.getItem('token')\r\n        });\r\n        if (res.code == 200) {\r\n          this.istextb = false;\r\n          this.$message({\r\n            message: '保存成功',\r\n            type: 'success'\r\n          });\r\n          this.textarea = \"\"\r\n          this.keyWorddetail()\r\n        } else {\r\n          this.error(res.msg)\r\n        }\r\n      },\r\n      //播放视频\r\n      openvideo(url) {\r\n        this.videoopenurl = url;\r\n        this.dialogVisible = true;\r\n      },\r\n      //相册图片上传\r\n      async bg_img1(file) {\r\n        //获取上传凭证\r\n        if (file.code == 200) {\r\n          this.isvideo_img = 1;\r\n          this.uploadAuth = file.data.UploadAuth\r\n          this.uploadAddress = file.data.UploadAddress\r\n          this.videoId = file.data.ImageId\r\n          this.ImageURL = file.data.ImageURL //上传地址\r\n          var userData = '{\"Vod\":{}}'\r\n          this.uploader = this.createUploader()\r\n          this.uploader.addFile(this.file, null, null, null, userData)\r\n          this.uploader.startUpload()\r\n        } else {\r\n          this.error(file.msg)\r\n        }\r\n      },\r\n      //文件上传\r\n      createUploader(type) {\r\n        let self = this\r\n        let uploader = new AliyunUpload.Vod({\r\n          timeout: self.timeout || 60000,\r\n          partSize: self.partSize || 1048576,\r\n          parallel: self.parallel || 5,\r\n          retryCount: self.retryCount || 3,\r\n          retryDuration: self.retryDuration || 2,\r\n          region: self.region,\r\n          userId: self.userId,\r\n          // 开始上传\r\n          onUploadstarted: function(uploadInfo) {\r\n            uploader.setUploadAuthAndAddress(uploadInfo, self.uploadAuth, self.uploadAddress, self.videoId)\r\n          },\r\n          // 文件上传成功\r\n          onUploadSucceed: function(uploadInfo) {\r\n            self.addImg();\r\n          },\r\n          onUploadProgress: function(uploadInfo, totalSize, progress) {\r\n            self.$message({\r\n              message: '文件上传中' + uploadInfo.file.name + \", fileSize:\" + totalSize + \", percent:\" + Math.ceil(\r\n                progress * 100) + \"%\",\r\n            });\r\n          },\r\n          // 文件上传失败\r\n          onUploadFailed: function(uploadInfo, code, message) {\r\n            self.uploadAuth = ''\r\n            self.uploadAddress = ''\r\n            self.videoId = ''\r\n            self.ImageURL = '' //上传地址\r\n            self.error(\"文件上传失败: \" + uploadInfo.file.name + \", code: \" + code + \", message:\" + message)\r\n          },\r\n          // 取消文件上传\r\n          onUploadCanceled: function(uploadInfo, code, message) {\r\n            self.error(\"文件已暂停上传: \" + uploadInfo.file.name + \", code: \" + code + \", message:\" + message)\r\n          },\r\n        })\r\n        return uploader\r\n      },\r\n      async addImg() {\r\n        var data = '';\r\n        if (this.isvideo_img == 1) { // 1 == img  2== video\r\n          let res = await this.$api.addImg({\r\n            keyword_id: this.data.id,\r\n            keyword: this.data.keyword,\r\n            media_id: this.videoId,\r\n            media_name: this.data.keyword,\r\n            media_ext: 'png',\r\n            media_cate_id: '5099',\r\n            media_url: this.ImageURL,\r\n            token: localStorage.getItem('token')\r\n          });\r\n          data = res\r\n          this.$refs.cropperUpload.clearFiles()\r\n        } else {\r\n          let res = await this.$api.addvideo({\r\n            keyword_id: this.data.id,\r\n            keyword: this.data.keyword,\r\n            media_id: this.videoId,\r\n            media_name: this.data.keyword,\r\n            media_ext: 'mp4',\r\n            media_cate_id: '5100',\r\n            token: localStorage.getItem('token')\r\n          });\r\n          data = res\r\n          this.$refs.cropperUploadvideo.clearFiles()\r\n        }\r\n        if (data.code == 200) {\r\n          this.keyWorddetail()\r\n          self.uploadAuth = ''\r\n          self.uploadAddress = ''\r\n          self.videoId = ''\r\n          self.ImageURL = '' //上传地址\r\n          this.$message({\r\n            message: '上传成功',\r\n            type: 'success'\r\n          });\r\n        }\r\n      },\r\n      //删除列表\r\n      handleCheckChange(val) {\r\n        this.numlist = val.length\r\n        let arrdel = [];\r\n        for (var i = 0; i < val.length; i++) {\r\n          arrdel.push(val[i].id)\r\n        }\r\n        this.imghandleCheckChange = arrdel\r\n      },\r\n      //最终删除\r\n      async okdelete() {\r\n        let res = await this.$api.deletedata({\r\n          ids: this.cancelname == 'img' ? this.imghandleCheckChange : this.videohandleCheckChange,\r\n          keyword_id: this.data.id,\r\n          type: this.cancelname == 'img' ? 0 : 1,\r\n          token: localStorage.getItem('token')\r\n        });\r\n        if (this.cancelname == 'img') {\r\n          this.checkAll = [],\r\n            this.numlist = 0\r\n        } else {\r\n          this.checkAllvideo = [],\r\n            this.videonumlist = 0\r\n        }\r\n        if (res.code == 200) {\r\n          this.$message({\r\n            message: '删除成功',\r\n            type: 'success'\r\n          });\r\n          this.keyWorddetail();\r\n        } else {\r\n          this.error(res.msg)\r\n        }\r\n      },\r\n      // 删除视频\r\n      handleCheckChangevideo(val) {\r\n        this.videonumlist = val.length\r\n        let arrdel = [];\r\n        for (var i = 0; i < val.length; i++) {\r\n          arrdel.push(val[i].id)\r\n        }\r\n        this.videohandleCheckChange = arrdel\r\n      },\r\n      //删除文本\r\n      async deletetextok(id) {\r\n        console.log(id)\r\n        let res = await this.$api.deletedata({\r\n          ids: id.id,\r\n          keyword_id: this.data.id,\r\n          type: 2,\r\n          token: localStorage.getItem('token')\r\n        });\r\n        if (res.code == 200) {\r\n          this.$message({\r\n            message: '删除成功',\r\n            type: 'success'\r\n          });\r\n          this.keyWorddetail();\r\n        } else {\r\n          this.error(res.msg)\r\n        }\r\n      },\r\n      //获取文件对象\r\n      filedata(event, file, fileList) {\r\n        this.file = file.raw\r\n      },\r\n      //取消选中\r\n      cancel() {\r\n        if (this.cancelname == 'img') {\r\n          this.checkAll = [],\r\n            this.numlist = 0\r\n        } else {\r\n          this.checkAllvideo = [],\r\n            this.videonumlist = 0\r\n        }\r\n      },\r\n      handleClick(tab, event) {\r\n        this.cancelname = tab.name\r\n      },\r\n      videofiledataf(event, file, fileList) {\r\n        this.videofiledata = file.raw\r\n      },\r\n      error(msg) {\r\n        this.$notify.error({\r\n          title: '错误',\r\n          message: msg\r\n        });\r\n      }\r\n    },\r\n  };\r\n</script>\r\n<style>\r\n  .el-card__body {\r\n    padding: 0px;\r\n  }\r\n</style>\n"]}]}